version: 2.1
jobs:
  check_docker_image_building:
    machine:
      image: ubuntu-2004:202101-01
    steps:
      - checkout
      - run:
          name: Build nginx image
          command: docker build -t nginx:check ./web
     
  check_docker_compose_up_command:
     machine:
      image: ubuntu-2004:202101-01
     steps:
      - checkout
      - run:
          name: Run docker-compose up command
          command: docker-compose up -d

workflows:
  version: 2
  build_image:
    jobs:
      - check_docker_image_building:
          filters:
            branches:
             only: main
      - check_docker_compose_up_command:
          filters:
            branches:
             only: main
